<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>è²·å–è¡¨</title>
  <link rel="icon" href="data:,">
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

  <style>
    /* â˜…â˜…â˜… ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®šã‚¨ãƒªã‚¢ â˜…â˜…â˜… */
    :root {
      --accent: #58BDD7; 
      --accent-hover: #4aaec7;
      --price-color: #ffffff;
      --bg-dark: #121212;
      --card-bg: #1e1e1e;
      --text-main: #ffffff;
      --border: #555555;
      --glow-text: 0 0 8px rgba(88, 189, 215, 0.6);
      --glow-price: 0 0 10px rgba(255, 255, 255, 0.7); 
    }

    /* éƒµé€è²·å–ãƒ¢ãƒ¼ãƒ‰ã®ã‚«ãƒ©ãƒ¼ã‚¹ã‚­ãƒ¼ãƒ ï¼ˆè–„ç´«ï¼‰ */
    body.mail-mode {
      --accent: #b472ff; 
      --accent-hover: #9e5be0;
      --glow-text: 0 0 8px rgba(180, 114, 255, 0.6);
      --glow-price: 0 0 10px rgba(255, 255, 255, 0.7); 
    }

    body { 
      font-family: "Helvetica Neue", Arial, sans-serif; 
      margin: 0; padding: 0; 
      color: var(--text-main);
      background-color: var(--bg-dark);
      background-image: url('./bg-gray.jpg.png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      padding-bottom: 80px; /* ã‚«ãƒ¼ãƒˆãƒãƒ¼ç”¨ã®ä½™ç™½ */
    }
    
    body::before {
      content: "";
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.7); 
      z-index: -1;
    }

    * { box-sizing: border-box; }

    /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
    header { 
      background: #111; 
      border-bottom: 2px solid var(--accent); 
      padding: 10px 15px; 
      text-align: center; 
      position: relative;
      z-index: 10;
      transition: border-bottom 0.5s ease;
    }

    .hamburger {
      position: absolute; left: 15px; top: 50%; transform: translateY(-50%);
      width: 28px; height: 20px; cursor: pointer; z-index: 100;
      display: flex; flex-direction: column; justify-content: space-between;
    }
    .hamburger span {
      display: block; height: 3px; width: 100%; background: var(--text-main); border-radius: 3px; transition: 0.3s;
    }

    /* ãƒ‰ãƒ­ãƒ¯ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
    .drawer {
      position: fixed; top: 0; left: -280px; width: 260px; height: 100%;
      background: #1a1a1a; z-index: 99999; transition: left 0.3s ease;
      box-shadow: 2px 0 15px rgba(0,0,0,0.8); display: flex; flex-direction: column;
    }
    .drawer.open { left: 0; }
    .drawer-header {
      padding: 25px 20px; font-size: 20px; font-weight: bold; color: var(--accent);
      border-bottom: 1px solid #333; background: #111;
    }
    .drawer-list { list-style: none; padding: 0; margin: 0; overflow-y: auto; }
    .drawer-item {
      padding: 18px 20px; border-bottom: 1px solid #2a2a2a; cursor: pointer; color: #eee; font-weight: bold;
    }
    .drawer-item:hover { background: #2a2a2a; color: var(--accent); }
    .drawer-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.7); backdrop-filter: blur(2px); z-index: 99998;
      display: none; opacity: 0; transition: opacity 0.3s ease;
    }
    .drawer-overlay.open { display: block; opacity: 1; }

    /* ã‚¿ã‚¤ãƒˆãƒ« */
    h1 { 
      margin: 0; line-height: 1; display: flex; align-items: center; justify-content: center; gap: 15px; position: relative; 
    }
    .logo-img { height: 80px; width: auto; max-width: 100%; object-fit: contain; }
    .title-text {
      font-size: 32px; font-weight: 800; color: var(--accent); text-shadow: var(--glow-text);
      font-style: italic; letter-spacing: 2px; white-space: nowrap;
    }
    
    #date-display {
      position: absolute; top: 50%; right: 20px; transform: translateY(-50%);
      font-size: 11px; color: #fff; font-weight: bold;
      border: 1px solid var(--accent); background: rgba(88, 189, 215, 0.15);
      padding: 5px 12px; border-radius: 20px; white-space: nowrap;
    }
    body.mail-mode #date-display { background: rgba(180, 114, 255, 0.15); }

    /* â˜…â˜…â˜… ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ãƒãƒŠãƒ¼ â˜…â˜…â˜… */
    .slider-container {
      width: 100%; max-width: 1000px; margin: 0 auto;
      position: relative; overflow: hidden; display: none; background: #000;
    }
    body.mail-mode .slider-container { display: block; }
    
    .slider-wrapper {
      display: flex; transition: transform 0.5s ease-in-out;
    }
    .slider-slide {
      min-width: 100%; box-sizing: border-box;
    }
    .slider-slide img {
      width: 100%; height: auto; display: block; max-height: 250px; object-fit: cover;
    }
    /* ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
    .slider-dots {
      position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
      display: flex; gap: 8px;
    }
    .slider-dot {
      width: 8px; height: 8px; background: rgba(255,255,255,0.5); border-radius: 50%; cursor: pointer;
    }
    .slider-dot.active { background: #fff; transform: scale(1.2); }

    /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
    .sticky-container {
      position: sticky; top: 0; z-index: 9990;
      background: rgba(18, 18, 18, 0.95); backdrop-filter: blur(5px);
      border-bottom: 1px solid #444; box-shadow: 0 4px 12px rgba(0,0,0,0.5);
    }
    .nav-scroll { overflow-x: auto; white-space: nowrap; padding: 0 10px; border-bottom: 1px solid #333; }
    .nav-tabs { display: flex; gap: 10px; max-width: 1000px; margin: 0 auto; padding: 0; list-style: none; align-items: center; }
    .nav-item { cursor: pointer; padding: 14px 12px; font-weight: bold; color: #888; border-bottom: 3px solid transparent; transition: 0.3s; font-size: 14px; }
    .nav-item.active { color: var(--accent); border-bottom-color: var(--accent); text-shadow: var(--glow-text); }

    .filters { 
      max-width: 1000px; margin: 0 auto; padding: 10px 12px; 
      display: flex; gap: 8px; flex-wrap: wrap; align-items: center;
    }
    .search-box { flex: 1; min-width: 150px; position: relative; }
    .search-box input { 
      width: 100%; padding: 10px 10px 10px 36px; border: 1px solid #555; border-radius: 4px; 
      outline: none; font-size: 14px; background: rgba(30, 30, 30, 0.8); color: #fff;
    }
    .search-icon { position: absolute; left: 10px; top: 11px; color: #aaa; }
    select, button { 
      padding: 10px; border: 1px solid #555; border-radius: 4px; 
      background: rgba(30, 30, 30, 0.8); color: #fff; cursor: pointer; font-size: 13px; 
    }
    button { background: var(--accent); border: none; font-weight: bold; transition: 0.3s; }
    button:hover { opacity: 0.8; }

    /* ã€Œè²·å–ã®æµã‚Œã€ãƒœã‚¿ãƒ³ï¼ˆéƒµé€ãƒ¢ãƒ¼ãƒ‰ç”¨ï¼‰ */
    .flow-btn {
      background: transparent; border: 1px solid var(--accent); color: var(--accent);
      display: none; align-items: center; gap: 5px;
    }
    body.mail-mode .flow-btn { display: flex; }
    body.mail-mode #showSoldOutLabel { display: none; } /* éƒµé€ãƒ¢ãƒ¼ãƒ‰ã§ã¯soldoutãƒ•ã‚£ãƒ«ã‚¿éè¡¨ç¤º */

    /* ã‚«ãƒ¼ãƒ‰ãƒªã‚¹ãƒˆ */
    .container { max-width: 1000px; margin: 20px auto 0; padding: 0 12px 20px; flex: 1; width: 100%; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 16px; }
    
    .card { 
      background: var(--card-bg); border-radius: 8px; overflow: hidden; 
      border: 1px solid var(--border); box-shadow: 0 4px 6px rgba(0,0,0,0.6);
      display: flex; flex-direction: column; position: relative; transition: all 0.2s ease;
    }
    /* åº—é ­ãƒ¢ãƒ¼ãƒ‰ã®ã¿hoverã§æµ®ã */
    body:not(.mail-mode) .card:hover { transform: translateY(-4px); border-color: var(--accent); }

    .card-img { width: 100%; aspect-ratio: 3/4; background: #000; object-fit: contain; border-bottom: 1px solid #333; }
    .card-body { padding: 10px; flex: 1; display: flex; flex-direction: column; }
    .type-label { font-size: 10px; color: var(--accent); font-weight: 900; margin-bottom: 4px; }
    .card-title { 
      font-size: 13px; font-weight: bold; line-height: 1.4; margin-bottom: 8px; color: #fff; 
      display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; height: 36px; 
    }
    .card-footer { margin-top: auto; border-top: 1px solid #444; padding-top: 8px; }
    
    .price-value { color: var(--price-color); font-size: 18px; font-weight: 800; }
    .limit { font-size: 10px; color: #aaa; float: right; margin-top: 6px;}

    /* â˜…â˜…â˜… ã‚«ãƒ¼ãƒˆæ“ä½œã‚¨ãƒªã‚¢ï¼ˆéƒµé€ãƒ¢ãƒ¼ãƒ‰ï¼‰ â˜…â˜…â˜… */
    .cart-actions {
      display: none; /* åº—é ­ãƒ¢ãƒ¼ãƒ‰ã§ã¯éè¡¨ç¤º */
      margin-top: 8px;
      gap: 5px;
      align-items: center;
    }
    body.mail-mode .cart-actions { display: flex; }

    /* æ•°é‡å¤‰æ›´UI */
    .qty-group {
      display: flex; align-items: center; border: 1px solid #555; border-radius: 4px; background: #fff; height: 32px;
    }
    .qty-btn {
      width: 28px; height: 100%; background: #fff; border: none; color: #333; font-weight: bold; font-size: 16px; padding: 0; display:flex; align-items:center; justify-content:center;
    }
    .qty-btn:hover { background: #eee; color: #000; }
    .qty-input {
      width: 30px; height: 100%; border: none; text-align: center; font-size: 14px; color: #333; font-weight: bold; outline: none; padding:0;
    }
    /* è¿½åŠ ãƒœã‚¿ãƒ³ */
    .add-btn {
      flex: 1; height: 32px; font-size: 13px; background: var(--accent); color: #fff; border-radius: 4px;
    }
    .add-btn:active { transform: scale(0.98); }

    /* â˜…â˜…â˜… ã‚«ãƒ¼ãƒˆå›ºå®šãƒ•ãƒƒã‚¿ãƒ¼ â˜…â˜…â˜… */
    .cart-bar {
      position: fixed; bottom: 0; left: 0; width: 100%;
      background: #1a1a1a; border-top: 2px solid var(--accent);
      padding: 15px; z-index: 20000;
      display: flex; justify-content: space-between; align-items: center;
      box-shadow: 0 -4px 20px rgba(0,0,0,0.8);
      transform: translateY(100%); transition: transform 0.3s ease;
    }
    .cart-bar.visible { transform: translateY(0); }
    .cart-total-info { font-size: 14px; font-weight: bold; color: #fff; }
    .cart-total-price { font-size: 20px; color: var(--accent); margin-right: 10px; }
    .check-cart-btn {
      padding: 10px 20px; background: var(--accent); color: #fff; font-weight: bold; border-radius: 4px;
    }

    /* ãƒ•ãƒƒã‚¿ãƒ¼ */
    footer {
      background: #0f0f0f; border-top: 1px solid #333; padding: 20px; text-align: center; margin-top: auto; position: relative;
    }
    .footer-version { position: absolute; bottom: 5px; left: 10px; font-size: 9px; color: #444; }

    /* â˜…â˜…â˜… è²·å–ã®æµã‚Œãƒ»è¦ç´„ãƒšãƒ¼ã‚¸ â˜…â˜…â˜… */
    #infoView {
      display: none; padding: 20px; max-width: 800px; margin: 0 auto; color: #ddd; line-height: 1.8; text-align: left;
    }
    .flow-step {
      background: #252525; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid var(--accent);
    }
    .flow-title { font-size: 18px; font-weight: bold; color: var(--accent); margin-bottom: 10px; }
    .faq-item { margin-bottom: 20px; }
    .faq-q { color: var(--accent); font-weight: bold; }
    .faq-a { margin-left: 10px; }
    .note-box { background: rgba(255, 0, 0, 0.1); border: 1px solid #ff5252; padding: 15px; border-radius: 8px; margin-top: 20px; }
    .note-title { color: #ff5252; font-weight: bold; margin-bottom: 5px; }

    /* ã‚¹ãƒãƒ›èª¿æ•´ */
    @media (max-width: 600px) {
      .grid { grid-template-columns: repeat(2, 1fr); gap: 10px; } /* ã‚¹ãƒãƒ›ã¯2åˆ— */
      .card-title { font-size: 11px; height: 32px; margin-bottom: 4px; }
      .qty-input { width: 20px; }
      .qty-btn { width: 24px; }
      .add-btn { font-size: 11px; }
      #date-display { position: static; display: block; margin: 5px auto 0; width: fit-content; transform: none; }
      h1 { height: auto; flex-wrap: wrap; }
      .logo-img { height: 50px; }
      .title-text { font-size: 20px; width: 100%; text-align: center; }
    }
  </style>
</head>
<body>

  <div id="drawerOverlay" class="drawer-overlay"></div>
  <div id="drawerMenu" class="drawer">
    <div class="drawer-header">MENU</div>
    <ul class="drawer-list">
      <li class="drawer-item" id="menuStore">åº—é ­è²·å–è¡¨</li>
      <li class="drawer-item" id="menuMail">éƒµé€è²·å–è¡¨</li>
      <li class="drawer-item" onclick="openInfo('privacy')">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</li>
      <li class="drawer-item" onclick="openInfo('terms')">åˆ©ç”¨è¦ç´„</li>
    </ul>
  </div>

  <div id="mainView">
    <header>
      <div class="hamburger" id="hamburgerBtn">
        <span></span><span></span><span></span>
      </div>
      <h1>
        <span class="title-text" id="mainTitle">åº—é ­è²·å–è¡¨</span>
        <img src="./logo.png.png.png.png" alt="ãƒ­ã‚´" class="logo-img" />
      </h1>
      <div id="date-display"></div>
    </header>

    <div class="slider-container" id="bannerSlider">
      <div class="slider-wrapper" id="sliderWrapper">
        </div>
      <div class="slider-dots" id="sliderDots"></div>
    </div>

    <div class="sticky-container">
      <div class="nav-scroll">
        <ul class="nav-tabs" id="categoryTabs">
          <li class="nav-item active" data-cat="ãƒã‚±ãƒ¢ãƒ³">ãƒã‚±ãƒ¢ãƒ³</li>
          <li class="nav-item" data-cat="ãƒ¯ãƒ³ãƒ”ãƒ¼ã‚¹">ãƒ¯ãƒ³ãƒ”ãƒ¼ã‚¹</li>
          <li class="nav-item" data-cat="ãƒ‰ãƒ©ã‚´ãƒ³ãƒœãƒ¼ãƒ«">ãƒ‰ãƒ©ã‚´ãƒ³ãƒœãƒ¼ãƒ«</li>
          <li class="nav-item" data-cat="éŠæˆ¯ç‹">éŠæˆ¯ç‹</li>
          <li class="nav-item" data-cat="ãƒ´ã‚¡ã‚¤ã‚¹">ãƒ´ã‚¡ã‚¤ã‚¹</li>
          <li class="nav-item" data-cat="ãã®ä»–">ãã®ä»–</li>
        </ul>
      </div>

      <div class="filters">
        <div class="search-box">
          <span class="search-icon">ğŸ”</span>
          <input id="q" placeholder="æ¤œç´¢" />
        </div>
        
        <select id="sort">
          <option value="price_desc" selected>é«˜ã„é †</option>
          <option value="price_asc">å®‰ã„é †</option>
          <option value="type_psa10">PSA10</option>
          <option value="type_mikaifu">æœªé–‹å°</option> <option value="type_sotai">ç´ ä½“</option>
          <option value="type_box">BOX</option>
        </select>

        <label id="showSoldOutLabel" style="display:flex; align-items:center; font-size:12px; cursor:pointer; gap:6px; margin-left:auto; color: #fff;">
          <input type="checkbox" id="showSoldOut" checked> è²·å–çµ‚äº†ã‚‚è¡¨ç¤º
        </label>

        <button id="flowBtn" class="flow-btn" onclick="openInfo('flow')">
          <i class="fa-solid fa-book-open"></i> è²·å–ã®æµã‚Œ
        </button>

        <button id="reload">æ›´æ–°</button>
      </div>
    </div>

    <div class="container">
      <div id="err" class="error"></div>
      <div class="muted" id="meta" style="font-size:12px; margin-bottom:10px; text-align:right; color:#bbb;"></div>
      <div id="grid" class="grid"></div>
      <div id="paginationCtrl" class="pagination" style="display:none;">
        <button id="prevBtn" class="page-btn">å‰ã¸</button>
        <span id="pageInfo" class="page-info">1 / 1</span>
        <button id="nextBtn" class="page-btn">æ¬¡ã¸</button>
      </div>
    </div>
  </div>

  <div id="cartBar" class="cart-bar">
    <div class="cart-total-info">
      åˆè¨ˆ <span class="cart-total-price" id="cartTotalPrice">Â¥0</span>
      <span id="cartTotalCount">(0ç‚¹)</span>
    </div>
    <button class="check-cart-btn" onclick="alert('ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ã¯ç¾åœ¨ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã§ã™ã€‚\nå®Ÿè£…ã«åˆã‚ã›ã¦é·ç§»å…ˆã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚')">ã‚«ãƒ¼ãƒˆã‚’ç¢ºèª</button>
  </div>

  <div id="infoView">
    <div class="back-btn-container">
      <button onclick="closeInfo()" style="padding:10px 30px; font-size:16px;">ä¸€è¦§ã«æˆ»ã‚‹</button>
    </div>
    <div id="infoContent"></div>
    <div class="back-btn-container" style="margin-top:40px;">
      <button onclick="closeInfo()" style="padding:10px 30px; font-size:16px;">ä¸€è¦§ã«æˆ»ã‚‹</button>
    </div>
  </div>

  <footer>
    <div class="footer-links">
      <a class="footer-link" onclick="openInfo('privacy')">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a>
      <span style="color:#333">|</span>
      <a class="footer-link" onclick="openInfo('terms')">åˆ©ç”¨è¦ç´„</a>
    </div>
    <div class="copyright">Â© 2026 ãƒˆãƒ¬ã‚«ãƒ•ã‚©ãƒ¼ã‚¹</div>
    <div class="footer-version">v7.0</div>
  </footer>

  <script>
    // â˜… GAS URL
    const API = "https://script.google.com/macros/s/AKfycbw08oFxfH6FsxcJ77mgNLeticvOFaq2rknNBK3emZgwmhsM5-sB_ltBhbuKamoXHkV8/exec";

    // â˜…â˜…â˜… è¨­å®šã‚¨ãƒªã‚¢ â˜…â˜…â˜…
    // ãƒãƒŠãƒ¼ç”»åƒï¼ˆéƒµé€ç”¨ï¼‰URLãƒªã‚¹ãƒˆï¼šæœ€å¤§5æšã¾ã§
    const BANNER_IMAGES = [
      "https://via.placeholder.com/1000x250/333/fff?text=Banner+1",
      "https://via.placeholder.com/1000x250/555/fff?text=Banner+2",
      "https://via.placeholder.com/1000x250/777/fff?text=Banner+3"
    ];

    // ã‚¹ãƒ†ãƒ¼ãƒˆå¤‰æ•°
    let ALL_DATA = {};
    let CURRENT_ITEMS = []; 
    let CUR_PAGE = 1;
    const ITEMS_per_PAGE = 60;
    let CART = {}; // { itemKey: quantity }

    const urlParams = new URLSearchParams(window.location.search);
    let currentCategory = urlParams.get('cat') || "ãƒã‚±ãƒ¢ãƒ³";
    let isMailMode = urlParams.get('mode') === 'mail';

    const el = (id) => document.getElementById(id);
    const yen = (n) => "Â¥" + Number(n).toLocaleString();

    // æ—¥ä»˜æ›´æ–°
    function updateDate(dateObj) {
        if (!dateObj) dateObj = new Date(); 
        const y = dateObj.getFullYear();
        const m = String(dateObj.getMonth() + 1).padStart(2, '0');
        const d = String(dateObj.getDate()).padStart(2, '0');
        const h = String(dateObj.getHours()).padStart(2, '0');
        const min = String(dateObj.getMinutes()).padStart(2, '0');
        el("date-display").textContent = `${y}/${m}/${d} ${h}:${min} æ›´æ–°`;
    }
    updateDate();

    // â˜… ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
    function updateModeUI() {
      if (isMailMode) {
        document.body.classList.add('mail-mode');
        el("mainTitle").textContent = "éƒµé€è²·å–è¡¨";
        initSlider(); // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼èµ·å‹•
        renderCartBar(); // ã‚«ãƒ¼ãƒˆãƒãƒ¼è¡¨ç¤ºæ›´æ–°
      } else {
        document.body.classList.remove('mail-mode');
        el("mainTitle").textContent = "åº—é ­è²·å–è¡¨";
        el("cartBar").classList.remove("visible");
      }
    }

    // â˜… ãƒãƒŠãƒ¼ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ãƒ­ã‚¸ãƒƒã‚¯
    let sliderInterval;
    function initSlider() {
      const wrapper = el("sliderWrapper");
      const dotsContainer = el("sliderDots");
      if(BANNER_IMAGES.length === 0) {
        el("bannerSlider").style.display = 'none'; return;
      }
      
      // ç”Ÿæˆ
      wrapper.innerHTML = BANNER_IMAGES.map(src => `<div class="slider-slide"><img src="${src}"></div>`).join("");
      dotsContainer.innerHTML = BANNER_IMAGES.map((_, i) => `<div class="slider-dot ${i===0?'active':''}" data-index="${i}"></div>`).join("");

      let curIndex = 0;
      const slides = document.querySelectorAll(".slider-slide");
      const dots = document.querySelectorAll(".slider-dot");

      function showSlide(index) {
        curIndex = index;
        wrapper.style.transform = `translateX(-${curIndex * 100}%)`;
        dots.forEach(d => d.classList.remove("active"));
        dots[curIndex].classList.add("active");
      }

      // è‡ªå‹•å†ç”Ÿ
      clearInterval(sliderInterval);
      sliderInterval = setInterval(() => {
        let next = (curIndex + 1) % BANNER_IMAGES.length;
        showSlide(next);
      }, 4000); // 4ç§’ã”ã¨

      // ãƒ‰ãƒƒãƒˆã‚¯ãƒªãƒƒã‚¯
      dots.forEach(dot => {
        dot.addEventListener("click", () => {
          showSlide(parseInt(dot.dataset.index));
          clearInterval(sliderInterval); // ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰ä¸€æ™‚åœæ­¢ï¼ˆä»»æ„ï¼‰
        });
      });
    }

    // â˜… ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰
    function getSheetName() { return isMailMode ? "éƒµé€" + currentCategory : currentCategory; }
    function updateURL() {
      const newUrl = new URL(window.location);
      newUrl.searchParams.set('cat', currentCategory);
      if (isMailMode) newUrl.searchParams.set('mode', 'mail');
      else newUrl.searchParams.delete('mode');
      window.history.pushState({}, '', newUrl);
    }

    // ãƒ¡ãƒ‹ãƒ¥ãƒ¼åˆ¶å¾¡
    const drawerMenu = el("drawerMenu");
    const drawerOverlay = el("drawerOverlay");
    function toggleDrawer() {
      drawerMenu.classList.toggle("open");
      drawerOverlay.classList.toggle("open");
    }
    el("hamburgerBtn").addEventListener("click", toggleDrawer);
    drawerOverlay.addEventListener("click", toggleDrawer);

    el("menuStore").addEventListener("click", () => {
      if (isMailMode) { isMailMode = false; updateModeUI(); updateURL(); loadData(); }
      toggleDrawer();
    });
    el("menuMail").addEventListener("click", () => {
      if (!isMailMode) { isMailMode = true; updateModeUI(); updateURL(); loadData(); }
      toggleDrawer();
    });

    // ã‚¿ãƒ–åˆ‡æ›¿
    document.querySelectorAll(".nav-item").forEach(tab => {
      tab.addEventListener("click", (e) => {
        document.querySelectorAll(".nav-item").forEach(t => t.classList.remove("active"));
        e.target.classList.add("active");
        currentCategory = e.target.getAttribute("data-cat");
        updateURL();
        loadData();
      });
    });

    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆ
    el("sort").addEventListener("change", () => render());
    el("showSoldOut").addEventListener("change", () => render());
    el("reload").addEventListener("click", () => { ALL_DATA = {}; loadData(); });
    let timer;
    el("q").addEventListener("input", () => { clearTimeout(timer); timer = setTimeout(() => render(), 300); });

    const typePriority = { "PSA10": 1, "æœªé–‹å°": 2, "ç´ ä½“": 3, "BOX": 4 };
    const getPrio = (t) => typePriority[t] || 99; 

    // â˜… ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ‰å‡¦ç†
    async function loadData() {
      const sheetName = getSheetName();
      if (ALL_DATA[sheetName]) { render(); return; }

      el("grid").innerHTML = '<div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>';
      el("paginationCtrl").style.display = "none";
      el("err").style.display = "none";

      try {
        const params = new URLSearchParams(); params.set("category", sheetName);
        const res = await fetch(`${API}?${params.toString()}&t=${Date.now()}`);
        const data = await res.json();
        updateDate(new Date());

        if (data.error) {
          el("err").textContent = data.error; el("err").style.display = "block"; el("grid").innerHTML = ""; return;
        }
        ALL_DATA[sheetName] = data;
        render();
      } catch (e) {
        el("grid").innerHTML = ""; el("err").textContent = "Error: " + e.message; el("err").style.display = "block";
      }
    }

    // â˜… æç”»å‡¦ç†
    function render() {
        const sheetName = getSheetName();
        const categoryData = ALL_DATA[sheetName];
        const grid = el("grid");
        const meta = el("meta");
        const stickyContainer = document.querySelector('.sticky-container');
        const pagCtrl = el("paginationCtrl");

        meta.textContent = "";
        
        // é–‰åº—ãƒã‚§ãƒƒã‚¯
        if (categoryData && categoryData.isOpen === false) {
           stickyContainer.style.display = 'none'; pagCtrl.style.display = 'none';
           grid.innerHTML = `<div class="closed-message-container"><div class="closed-title">å—ä»˜çµ‚äº†</div><div class="closed-text">æœ¬æ—¥ã®è²·å–å—ä»˜ã¯çµ‚äº†ã„ãŸã—ã¾ã—ãŸã€‚<br>ã¾ãŸæ˜æ—¥ä»¥é™ã®ã”åˆ©ç”¨ã‚’<br>å¿ƒã‚ˆã‚ŠãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™ã€‚</div></div>`;
           return;
        }
        stickyContainer.style.display = 'block';

        if (!categoryData || !categoryData.items || categoryData.items.length === 0) {
          pagCtrl.style.display = 'none';
          grid.innerHTML = '<div class="loading">è©²å½“ãªã—</div>';
          return;
        }

        const q = el("q").value.trim().toLowerCase();
        const sort = el("sort").value;
        const showSoldOut = el("showSoldOut").checked; // åº—é ­ã®ã¿æœ‰åŠ¹

        let items = categoryData.items.slice(); 

        if (q) {
          items = items.filter(item => 
            (item.name && item.name.toLowerCase().includes(q)) || (item.series && item.series.toLowerCase().includes(q))
          );
        }

        // åº—é ­ãƒ¢ãƒ¼ãƒ‰ã®ã¿ã€Œè²·å–çµ‚äº†ã‚‚è¡¨ç¤ºã€ãƒã‚§ãƒƒã‚¯ã‚’è¦‹ã‚‹ã€‚éƒµé€ãƒ¢ãƒ¼ãƒ‰ã¯å¸¸ã«å…¨è¡¨ç¤ºï¼ˆãŸã ã—çµ‚äº†ã¯ã‚«ãƒ¼ãƒˆä¸å¯ï¼‰
        if (!isMailMode && !showSoldOut) {
           items = items.filter(x => Number(x.remaining) > 0);
        }

        // çµã‚Šè¾¼ã¿
        if (sort.startsWith("type_")) {
             const t = sort.replace("type_", "").toUpperCase();
             items = items.filter(x => (x.type||"PSA10").toUpperCase() === t || (t==="MIKAIFU" && x.type==="æœªé–‹å°") || (t==="SOTAI" && x.type==="ç´ ä½“"));
        }

        // ã‚½ãƒ¼ãƒˆ
        items.sort((a, b) => {
          const pA = getPrio(a.type); const pB = getPrio(b.type);
          if (pA !== pB) return pA - pB;
          return sort === "price_asc" ? a.price - b.price : b.price - a.price;
        });

        CURRENT_ITEMS = items; 
        meta.textContent = `${currentCategory} (${items.length}ä»¶)`;
        CUR_PAGE = 1;
        renderPage(CUR_PAGE);
    }

    function renderPage(page) {
        const grid = el("grid");
        const start = (page - 1) * ITEMS_per_PAGE;
        const end = start + ITEMS_per_PAGE;
        const pageItems = CURRENT_ITEMS.slice(start, end);
        const totalPages = Math.ceil(CURRENT_ITEMS.length / ITEMS_per_PAGE);

        grid.innerHTML = pageItems.map((item, index) => {
          const globalIndex = start + index;
          const isSoldOut = Number(item.remaining) <= 0;
          let imgTag = item.imageUrl ? `<img src="${item.imageUrl}" class="card-img" loading="lazy" />` : `<div class="card-img no-img">No Image</div>`;
          
          let badgeHtml = "";
          if ((item.type === "ç´ ä½“") && item.grade) badgeHtml = `<span class="badge badge-sotai">${item.grade}</span>`;

          // --- éƒµé€ãƒ¢ãƒ¼ãƒ‰ç”¨ã‚«ãƒ¼ãƒˆUI ---
          let actionHtml = "";
          if (isMailMode) {
            if (isSoldOut) {
              actionHtml = `<div style="text-align:center; color:#aaa; font-size:12px; margin-top:8px;">è²·å–çµ‚äº†</div>`;
            } else {
              // æ—¢ã«ã‚«ãƒ¼ãƒˆã«ã‚ã‚‹æ•°
              const inCart = CART[globalIndex] || 0;
              actionHtml = `
                <div class="cart-actions">
                  <div class="qty-group">
                    <button class="qty-btn" onclick="changeQty(${globalIndex}, -1)">-</button>
                    <input class="qty-input" id="qty-${globalIndex}" value="${inCart > 0 ? inCart : 1}" readonly>
                    <button class="qty-btn" onclick="changeQty(${globalIndex}, 1, ${item.remaining})">+</button>
                  </div>
                  <button class="add-btn" onclick="addToCart(${globalIndex})">è¿½åŠ </button>
                </div>
              `;
            }
          }

          // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ï¼ˆåº—é ­ãƒ¢ãƒ¼ãƒ‰ã®è²·å–çµ‚äº†æ™‚ï¼‰
          let overlayHtml = "";
          if (!isMailMode && isSoldOut) {
             overlayHtml = `<div style="position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); z-index:50; display:flex; align-items:center; justify-content:center;"><div class="sold-out-badge-style">è²·å–çµ‚äº†</div></div>`;
          }

          return `
            <div class="card ${isSoldOut ? 'sold-out' : ''}" data-index="${globalIndex}">
              ${overlayHtml}
              <div style="${isSoldOut ? 'opacity:0.6;' : ''}">
                ${imgTag}
                <div class="card-tags">${badgeHtml}</div>
                <div class="card-body">
                  <div class="type-label">ã€${item.type || "PSA10"}ã€‘</div>
                  <div class="card-title">${item.name}</div>
                  <div class="card-footer">
                    <div class="price-row">
                      <span class="price-label">è²·å–ä¾¡æ ¼</span>
                      <span class="price-value">${yen(item.price)}</span>
                    </div>
                    <div class="limit">æ®‹ã‚Š: ${item.remaining}</div>
                    ${actionHtml}
                  </div>
                </div>
              </div>
            </div>
          `;
        }).join("");

        const pagCtrl = el("paginationCtrl");
        if (totalPages > 1) {
            pagCtrl.style.display = "flex"; el("pageInfo").textContent = `${page} / ${totalPages}`;
            el("prevBtn").disabled = (page === 1); el("nextBtn").disabled = (page === totalPages);
        } else { pagCtrl.style.display = "none"; }
    }

    el("prevBtn").addEventListener("click", () => { if (CUR_PAGE > 1) { CUR_PAGE--; renderPage(CUR_PAGE); } });
    el("nextBtn").addEventListener("click", () => { if (CUR_PAGE < Math.ceil(CURRENT_ITEMS.length/ITEMS_per_PAGE)) { CUR_PAGE++; renderPage(CUR_PAGE); } });

    // â˜…â˜…â˜… ã‚«ãƒ¼ãƒˆãƒ­ã‚¸ãƒƒã‚¯ â˜…â˜…â˜…
    function changeQty(idx, delta, max) {
      const input = el(`qty-${idx}`);
      let val = parseInt(input.value) + delta;
      if (val < 1) val = 1;
      if (max && val > max) val = max;
      input.value = val;
    }

    function addToCart(idx) {
      const input = el(`qty-${idx}`);
      const qty = parseInt(input.value);
      const item = CURRENT_ITEMS[idx];
      
      // ã‚«ãƒ¼ãƒˆæ›´æ–°
      CART[idx] = qty; // ä¸Šæ›¸ããƒ¢ãƒ¼ãƒ‰ï¼ˆè¿½åŠ ãªã‚‰ += qty ã«å¤‰æ›´å¯ï¼‰
      
      // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³çš„ãªãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆãƒœã‚¿ãƒ³ã®è‰²ã‚’ä¸€ç¬å¤‰ãˆã‚‹ãªã©ï¼‰
      const btn = event.target;
      const originalText = btn.textContent;
      btn.textContent = "å®Œäº†";
      btn.style.background = "#aaa";
      setTimeout(() => {
        btn.textContent = originalText;
        btn.style.background = "";
      }, 500);

      renderCartBar();
    }

    function renderCartBar() {
      if (!isMailMode) return;
      const idxs = Object.keys(CART);
      if (idxs.length === 0) {
        el("cartBar").classList.remove("visible");
        return;
      }
      
      let totalCount = 0;
      let totalPrice = 0;
      idxs.forEach(idx => {
        const item = CURRENT_ITEMS[idx];
        const qty = CART[idx];
        if (item) {
          totalCount += qty;
          totalPrice += item.price * qty;
        }
      });

      el("cartTotalPrice").textContent = yen(totalPrice);
      el("cartTotalCount").textContent = `(${totalCount}ç‚¹)`;
      el("cartBar").classList.add("visible");
    }


    // â˜…â˜…â˜… æƒ…å ±ãƒšãƒ¼ã‚¸ï¼ˆè¦ç´„ãƒ»æµã‚Œï¼‰ â˜…â˜…â˜…
    const contentData = {
      privacy: `<h2>ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</h2><p>æ ªå¼ä¼šç¤¾Niutinyï¼ˆä»¥ä¸‹ã€Œå½“ç¤¾ã€ï¼‰ã¯...</p>`, // çœç•¥ï¼ˆå‰å›ã®å†…å®¹ï¼‰
      terms: `<h2>åˆ©ç”¨è¦ç´„</h2><p>ã“ã®åˆ©ç”¨è¦ç´„ã¯...</p>`, // çœç•¥ï¼ˆå‰å›ã®å†…å®¹ï¼‰
      
      flow: `
        <h2>éƒµé€è²·å–ã®æµã‚Œ</h2>
        
        <div class="flow-step">
          <div class="flow-title">STEP 1ï½œå•†å“ã‚’ã‚«ãƒ¼ãƒˆã¸å…¥ã‚Œã¦ç”³ã—è¾¼ã¿</div>
          <p>è²·å–ä¸€è¦§ã«ã‚ã‚‹å•†å“ã¯ã€ãã®ã¾ã¾ã‚«ãƒ¼ãƒˆã¸è¿½åŠ ã—ã¦ç”³è¾¼æ‰‹ç¶šãã‚’ã—ã¦ãã ã•ã„ã€‚<br>
          ä¸€è¦§ã«è¦‹å½“ãŸã‚‰ãªã„å•†å“ã¯ã€<strong>ã€Œã¾ã¨ã‚ã¦è²·å–ã€</strong>ã‚’ã‚«ãƒ¼ãƒˆã«å…¥ã‚Œã¦ãŠç”³ã—è¾¼ã¿ãã ã•ã„ã€‚</p>
        </div>

        <div class="flow-step">
          <div class="flow-title">STEP 2ï½œå—ä»˜å®Œäº†ãƒ¡ãƒ¼ãƒ«ç¢ºèªå¾Œã«ç™ºé€</div>
          <p>ãŠç”³ã—è¾¼ã¿å†…å®¹ã®ç¢ºèªãŒå®Œäº†ã™ã‚‹ã¨ã€å—ä»˜ï¼ˆæ‰¿èªï¼‰ãƒ¡ãƒ¼ãƒ«ã‚’ãŠé€ã‚Šã—ã¾ã™ã€‚<br>
          ãƒ¡ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ã‹ã‚‰å•†å“ã‚’ç™ºé€ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="flow-step">
          <div class="flow-title">STEP 3ï½œæŸ»å®šçµæœã®ç¢ºèªãƒ»æ‰¿è«¾</div>
          <p>å•†å“åˆ°ç€å¾Œã«æŸ»å®šã‚’è¡Œã„ã€çµæœã‚’å–å¼•ãƒšãƒ¼ã‚¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã”æ¡ˆå†…ã—ã¾ã™ã€‚<br>
          å†…å®¹ã‚’ã”ç¢ºèªã®ã†ãˆã€å–å¼•ç”»é¢ã‹ã‚‰æ‰¿è«¾ï¼ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã®ãŠæ‰‹ç¶šãã‚’è¡Œã£ã¦ãã ã•ã„ã€‚<br>
          <small>â€»ã™ã¹ã¦æº€é¡æŸ»å®šã®å ´åˆã¯ã€æ‰¿è«¾æ“ä½œãŒä¸è¦ã¨ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</small></p>
        </div>

        <hr style="border-color:#444; margin:30px 0;">

        <h3>ã‚ˆãã‚ã‚‹è³ªå•ï¼ˆFAQï¼‰</h3>
        
        <div class="faq-item">
          <div class="faq-q">Q. æŸ»å®šã¨å…¥é‡‘ã¾ã§ã©ã‚Œãã‚‰ã„ï¼Ÿ</div>
          <div class="faq-a">A. å•†å“åˆ°ç€å¾Œã€åŸå‰‡ã¨ã—ã¦å½“æ—¥ä¸­ã«æŸ»å®šã¨æŒ¯è¾¼å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Q. é€æ–™ã¯å¿…è¦ï¼Ÿ</div>
          <div class="faq-a">A. ç™ºé€æ™‚ã®é€æ–™ã¯ãŠå®¢æ§˜è² æ‹…ã¨ãªã‚Šã¾ã™ã€‚</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Q. ç”³è¾¼æ›¸ã‚„èº«åˆ†è¨¼ã®å°åˆ·ãƒ»åŒæ¢±ã¯å¿…è¦ï¼Ÿ</div>
          <div class="faq-a">A. ä¸è¦ã§ã™ã€‚æ¡ˆå†…ã«æ²¿ã£ã¦ã€èº«åˆ†è¨¼ã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§æå‡ºã§ãã¾ã™ã€‚</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Q. ä¸€è¦§ã«ãªã„å•†å“ã‚‚ç”³ã—è¾¼ã‚ã‚‹ï¼Ÿ</div>
          <div class="faq-a">A. å¯èƒ½ã§ã™ã€‚<strong>ã€Œã¾ã¨ã‚ã¦è²·å–ã€</strong>ã‚’ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã—ã¦ç™ºé€ã—ã¦ãã ã•ã„ã€‚åˆ°ç€å¾Œã«ã‚¹ã‚¿ãƒƒãƒ•ãŒæŸ»å®šã—ã¾ã™ã€‚</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Q. ç”³ã—è¾¼ã¿å¾Œã®é€£çµ¡ã¯ã©ã†ã™ã‚‹ï¼Ÿ</div>
          <div class="faq-a">A. å–å¼•ãƒšãƒ¼ã‚¸å†…ã®<strong>ãƒãƒ£ãƒƒãƒˆï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰</strong>ã§ã‚„ã‚Šå–ã‚Šã§ãã¾ã™ã€‚</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Q. ç™ºé€å¾Œã«ã‚„ã£ã±ã‚Šã‚„ã‚ãŸã„å ´åˆã¯ï¼Ÿ</div>
          <div class="faq-a">A. æŸ»å®šçµæœã«ç´å¾—ã§ããªã„å ´åˆã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½ã§ã™ã€‚<br>ãŸã ã—ã€ç”³è¾¼æ™‚ã®é‡‘é¡ã‹ã‚‰æ¸›é¡ãŒãªã„ï¼ˆæº€é¡ï¼‰å ´åˆã¯ã€åŸå‰‡ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã§ãã¾ã›ã‚“ã€‚<br>â€»è¿”é€ãŒç™ºç”Ÿã™ã‚‹å ´åˆã®é€æ–™ã¯ãŠå®¢æ§˜è² æ‹…ã§ã™ã€‚</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Q. æŸ»å®šæ–™ã‚„æŒ¯è¾¼æ‰‹æ•°æ–™ã¯ã‹ã‹ã‚‹ï¼Ÿ</div>
          <div class="faq-a">A. <strong>ã‹ã‹ã‚Šã¾ã›ã‚“ï¼ˆç„¡æ–™ï¼‰</strong>ã§ã™ã€‚</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Q. äº‹å‰ã«ã ã„ãŸã„ã®é‡‘é¡ã‚’çŸ¥ã‚ŠãŸã„</div>
          <div class="faq-a">A. å…¬å¼LINEã§ç›¸è«‡ã§ãã¾ã™ã€‚å†™çœŸã‚’é€ã‚Œã°ã€ã‚¹ã‚¿ãƒƒãƒ•ãŒä»®æŸ»å®šã—ã¾ã™ã€‚</div>
        </div>

        <div class="note-box">
          <div class="note-title">ã”åˆ©ç”¨å‰ã®æ³¨æ„äº‹é …</div>
          <p><strong>ç™ºé€æœŸé™ã¨ä¾¡æ ¼ã®å–ã‚Šæ‰±ã„</strong><br>
          â€¢ æ‰¿èªï¼ˆå—ä»˜ï¼‰é€£çµ¡ãŒ19:00ä»¥å‰ï¼šå½“æ—¥ç™ºé€ã€œç¿Œæ—¥åˆ°ç€ã¾ã§ã€ç”³è¾¼æ™‚ã®ä¾¡æ ¼ã‚’åŸºæº–ã«å¯¾å¿œ<br>
          â€¢ æ‰¿èªï¼ˆå—ä»˜ï¼‰é€£çµ¡ãŒ19:00ä»¥é™ï¼šç¿Œæ—¥ç™ºé€ã€œç¿Œã€…æ—¥åˆ°ç€ã¾ã§ã€ç”³è¾¼æ™‚ã®ä¾¡æ ¼ã‚’åŸºæº–ã«å¯¾å¿œ<br>
          â€¢ é æ–¹åœ°åŸŸãªã©ã§åˆ°ç€ã«2æ—¥ä»¥ä¸Šã‹ã‹ã‚‹å ´åˆã¯ã€ã•ã‚‰ã«+1æ—¥ã‚’ç›®å®‰ã«å–ã‚Šæ‰±ã„ã¾ã™</p>
          <p><small>â€»æ¡ä»¶ã‚’æº€ãŸã•ãªã„å ´åˆã€åˆ°ç€æ™‚ç‚¹ã®ä¾¡æ ¼ãƒ»çŠ¶æ…‹ã‚’ã‚‚ã¨ã«æŸ»å®šã¨ãªã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
          â€»ã€Œç™ºé€ã€ã®åˆ¤å®šã¯ã€ã‚³ãƒ³ãƒ“ãƒ‹å—ä»˜ã§ã¯ãªãé…é€ä¼šç¤¾ã®é›†è·ãƒ»ç™ºé€å‡¦ç†ãŒåŸºæº–ã§ã™ã€‚</small></p>
          
          <p><strong>ä¾¡æ ¼ã®å¤‰å‹•ã«ã¤ã„ã¦</strong><br>
          æ²è¼‰ä¾¡æ ¼ãŒé€”ä¸­ã§å¤‰ã‚ã£ã¦ã‚‚ã€æŸ»å®šã¯åŸå‰‡ã¨ã—ã¦ç”³è¾¼æ™‚ç‚¹ã®ä¾¡æ ¼ã‚’åŸºæº–ã«è¡Œã„ã¾ã™ã€‚<br>
          ç”³è¾¼å¾Œã€œåˆ°ç€ã¾ã§ã®ä¾¡æ ¼å¤‰å‹•ã‚’ç†ç”±ã¨ã—ãŸå¤‰æ›´ä¾é ¼ã¯ãŠå—ã‘ã§ãã¾ã›ã‚“ã€‚</p>

          <p><strong>ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒ»è¿”é€</strong><br>
          ç”³è¾¼æ™‚ã®é‡‘é¡ã¨åŒé¡ï¼ˆæº€é¡ï¼‰ã¨ãªã£ãŸå•†å“ã¯ã€åŸå‰‡ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã§ãã¾ã›ã‚“ã€‚<br>
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ãŸå•†å“ã®è¿”é€è²»ç”¨ã¯ãŠå®¢æ§˜è² æ‹…ã§ã™ã€‚</p>

          <p><strong>å…ç¨è³¼å…¥å“ã«ã¤ã„ã¦</strong><br>
          å…ç¨ã§è³¼å…¥ã—ãŸå•†å“ã¯è²·å–ã§ãã¾ã›ã‚“ã€‚ä¾é ¼å“ã«å…ç¨è³¼å…¥å“ãŒå«ã¾ã‚Œã¦ã„ãªã„ã“ã¨ã‚’ã”ç¢ºèªãã ã•ã„ã€‚</p>
        </div>
      `
    };

    // å‰å›çœç•¥ã—ãŸè¦ç´„ãƒ†ã‚­ã‚¹ãƒˆã‚’å¾©æ´»ï¼ˆå®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã«ã¯å‰å›æä¾›ã—ãŸãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥ã‚Œã¦ãã ã•ã„ï¼‰
    contentData.privacy = privacyText; 
    contentData.terms = termsText;

    function openInfo(type) {
      const mainView = el("mainView");
      const infoView = el("infoView");
      const content = el("infoContent");
      content.innerHTML = contentData[type];
      
      if (drawerMenu.classList.contains("open")) toggleDrawer();
      mainView.style.display = "none";
      infoView.style.display = "block";
      window.scrollTo(0, 0);
    }

    function closeInfo() {
      el("infoView").style.display = "none";
      el("mainView").style.display = "block";
      window.scrollTo(0, 0);
    }

    // åˆå›ãƒ­ãƒ¼ãƒ‰
    updateModeUI(); // URLã‹ã‚‰ãƒ¢ãƒ¼ãƒ‰åˆ¤å®š
    loadData();
  </script>
</body>
</html>
